@// Rythm template for dragtop http://www.bitplan.com/index.php/Dragtop
@// Java Analyzer example
@import org.apache.tinkerpop.gremlin.structure.Graph
@import org.apache.tinkerpop.gremlin.process.traversal.dsl.graph.GraphTraversalSource
@import org.apache.tinkerpop.gremlin.structure.Vertex
@import com.bitplan.simplegraph.core.SimpleNode
@import java.net.URI
@args {
  Graph graph;
}
@// display a header with the given title
@def header(String title) {
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>@(title)</title>
</head>
<body>
}
@// display a footer with the given title
@def footer() {
</body>
</html>
}
@def analyzeFiles(Graph graph) {
@{
  GraphTraversalSource g=graph.traversal();
  List<Vertex> dragtopItemNodes=g.V().hasLabel("dragtop.Item").toList()
}
  @for (Vertex dragtopItem:dragtopItemNodes) {
     @{
        String url=dragtopItem.property("url").value().toString();
        File aroot=null;
        if (!url.endsWith("rythm")) {
           aroot=new File(new URI(url));
        }
     }
     @if (aroot) {
       <h3>@(aroot.getPath())</h3>
    }
  }
}
@header("Java Analyzer")
@analyzeFiles(graph)
@footer()
